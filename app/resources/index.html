<!DOCTYPE html>
<head>
    <link rel="stylesheet" href="/style.css">
    <meta charset="UTF-8" />
    <title>Aim Trainer</title>
</head>

<body>
    <h1>Aim Trainer</h1>
    <button onclick="start_training()">Start</button>
    <time_left>30.0</time_left>

    <trainer><p></p></trainer>

    <script>

        let button = document.querySelector("button");

        async function start_training() {

            button.disabled = true;

            let trainer = document.querySelector("trainer");
            let time_left_node = document.querySelector("time_left")
            let startTime = Date.now();

            function countdown() {
                const elapsedTime = Date.now() - startTime;

                if (elapsedTime < 3000){
                    trainer.querySelector("p").innerHTML = ((3000 - elapsedTime) / 1000).toFixed(0);
                }

                if (elapsedTime >= 3000) {
                    trainer.querySelector("p").innerHTML = null;
                }
                
                if (elapsedTime > 3000){
                    time_left_node.innerHTML = ((33000 - elapsedTime) / 1000).toFixed(1);
                }

                if (elapsedTime >= 33000) {
                    clearInterval(countdown_id);
                    time_left_node.innerHTML = "Done!";
                }
            }

            countdown_id = setInterval(countdown, 100);
            return await new Promise(res => {setTimeout(() => {button.disabled = false;}, 33000);});
        }
    </script>
</body>